% RK4 Solver Update Equations

% Stage k1: Spatial discretization
% r derivative (2nd order)
\[
k_1^{(r)} = \Delta t \cdot \left( a begin i m p t x \right)
\]

% r derivative (4th order)
\[
k_1^{(r)} = \Delta t \cdot \left( a begin i m p t x \right)
\]

% theta derivative (2nd order)
\[
k_1^{(theta)} = \Delta t \cdot \left( \frac{r^{2} \left(- \sin^{2}{\left(dphi^{2} \left(h - \theta\right) \right)} + \sin^{2}{\left(dphi^{2} \left(h + \theta\right) \right)}\right)}{2 h} \right)
\]

% theta derivative (4th order)
\[
k_1^{(theta)} = \Delta t \cdot \left( \frac{r^{2} \left(- 8 \sin^{2}{\left(dphi^{2} \left(h - \theta\right) \right)} + 8 \sin^{2}{\left(dphi^{2} \left(h + \theta\right) \right)} + \sin^{2}{\left(dphi^{2} \left(2 h - \theta\right) \right)} - \sin^{2}{\left(dphi^{2} \left(2 h + \theta\right) \right)}\right)}{12 h} \right)
\]

% Stage k2: Half-step using k1
\[
k_2 = \Delta t \cdot F\left(X^n + \frac{k_1}{2}\right)
\]

% Stage k3: Half-step using k2
\[
k_3 = \Delta t \cdot F\left(X^n + \frac{k_2}{2}\right)
\]

% Stage k4: Full step using k3
\[
k_4 = \Delta t \cdot F\left(X^n + k_3\right)
\]

% Final RK4 update
\[
X^{n+1} = X^n + \frac{1}{6}\left(k_1 + 2k_2 + 2k_3 + k_4\right)
\]
